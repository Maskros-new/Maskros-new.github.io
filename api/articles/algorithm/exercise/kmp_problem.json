{"title":"kmpä¸“é¢˜è®­ç»ƒ","uid":"eb0105647eb3a218c386b75ad79d5f5a","slug":"algorithm/exercise/kmp_problem","date":"2021-11-26T13:59:50.000Z","updated":"2021-11-27T04:15:38.843Z","comments":true,"path":"api/articles/algorithm/exercise/kmp_problem.json","keywords":null,"cover":null,"content":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><h1 id=\"kmp-ekmp-ä¸“é¢˜è®­ç»ƒ\"><a href=\"#kmp-ekmp-ä¸“é¢˜è®­ç»ƒ\" class=\"headerlink\" title=\"kmp/ekmp ä¸“é¢˜è®­ç»ƒ\"></a>kmp/ekmp ä¸“é¢˜è®­ç»ƒ</h1><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>ğŸ´ç³™äººè ¢å‡‘åˆçœ‹</p></blockquote>\n<h2 id=\"0x01-å‰ªèŠ±å¸ƒæ¡-HDU-2087\"><a href=\"#0x01-å‰ªèŠ±å¸ƒæ¡-HDU-2087\" class=\"headerlink\" title=\"0x01 å‰ªèŠ±å¸ƒæ¡ HDU-2087\"></a>0x01 å‰ªèŠ±å¸ƒæ¡ HDU-2087</h2><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><a href=\"https://vjudge.net/problem/HDU-2087\">link</a></p>\n<p>çº¯çº¯kmpè£¸é¢˜ï¼Œä¸å¯é‡å è®¡æ•° </p></blockquote>\n<pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">#include&lt;bits&#x2F;stdc++.h&gt;\nusing namespace std;\nvoid kmp_pre(string p, int next[])\n&#123;\n    int i, j;\n    j &#x3D; next[0] &#x3D; -1;\n    i &#x3D; 0;\n    while (i &lt; p.length())\n    &#123;\n        while (-1 !&#x3D; j &amp;&amp; p[i] !&#x3D; p[j])\n            j &#x3D; next[j];\n        next[++i] &#x3D; ++j;\n    &#125;\n&#125;\nint kmp_Count(string x, string y, int next[])\n&#123; \n    int i, j;\n    int ans &#x3D; 0;\n    kmp_pre(x, next);\n    i &#x3D; j &#x3D; 0;\n    while (i &lt; y.length())\n    &#123;\n        while (-1 !&#x3D; j &amp;&amp; y[i] !&#x3D; x[j])\n            j &#x3D; next[j];\n        i++;\n        j++;\n        if (j &gt;&#x3D; x.length())\n        &#123;\n            ans++;\n            j &#x3D; 0;       &#x2F;&#x2F;ä¸å¯é‡å è®¡æ•°\n        &#125;\n    &#125;\n    return ans;\n&#125;\nint main()&#123;\n    string a,b;\n    int nxt[1005];\n    while(1)&#123;\n        cin&gt;&gt;a;\n        if(a&#x3D;&#x3D;&quot;#&quot;) break;\n        else&#123;\n            cin&gt;&gt;b;\n            memset(nxt,0,b.length()+1);\n            int ans&#x3D;kmp_Count(b,a,nxt);\n            cout&lt;&lt;ans&lt;&lt;endl;            \n        &#125;\n    &#125;    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"0x02-Secret-HDU-6153\"><a href=\"#0x02-Secret-HDU-6153\" class=\"headerlink\" title=\"0x02 Secret HDU-6153\"></a>0x02 Secret HDU-6153</h2><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><a href=\"https://vjudge.net/problem/HDU-6153\">link</a></p>\n<p>é¢˜æ„ï¼š</p>\n<p>ç»™ä¸¤ä¸ªä¸²s1,s2ï¼Œæ±‚s2æ‰€æœ‰çš„åç¼€å­ä¸²çš„é•¿åº¦ä¹˜åœ¨ä¸»ä¸²s1ä¸­å‡ºç°çš„æ¬¡æ•°ä¹‹å’Œ</p>\n<p>è§£æ³•ï¼š</p>\n<p>æŒ¨ä¸ªæšä¸¾åç¼€æ˜¯ğŸ·båšæ³•ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæŠŠå­—ç¬¦ä¸²<strong>ç¿»è½¬</strong>ï¼Œè¿™æ ·åç¼€å˜å‰ç¼€ï¼Œå°±æ¥åˆ°äº†æˆ‘ä»¬ç†Ÿæ‚‰çš„kmpåŒ¹é…ç¯èŠ‚</p>\n<p>è§£æ³•ä¸€ï¼šexkmp</p>\n<p>ç¿»è½¬åå‘ç°è¿™ä¸å°±æ­£å¥½åˆ©ç”¨extend[]æ•°ç»„çš„å®šä¹‰ç›´æ¥æ±‚è§£ï¼Œåšä¸€éekmpï¼Œéå†extend[]æ•°ç»„ï¼Œå¯¹æ¯ä¸ªå€¼åš <code>(1+entend[i])*entend[i]&gt;&gt;1</code> å¤„ç†ï¼Œå…¨éƒ¨åŠ å’Œå³ä¸ºç­”æ¡ˆ</p>\n<p>è§£æ³•äºŒï¼škmp</p>\n<p>åˆ©ç”¨å¯¹next[]æ•°ç»„çš„ç†è§£ï¼Œæš‚æ—¶é¸½äº†ï¼Œå› ä¸ºæƒ³äº†å¾ˆä¹…æ²¡æƒ³æ˜ç™½</p></blockquote>\n<p>è§£æ³•ä¸€ï¼š ekmp </p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>çŒ›waä¹‹åç»™äº†æˆ‘æ·±åˆ»çš„æ•™è®­ï¼šæ•°ç»„å¼€ longlongğŸ˜…ğŸ˜…</p></blockquote>\n<pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">#include &lt;bits&#x2F;stdc++.h&gt;\nusing namespace std;\nconst int mod &#x3D; 1000000007;\n#define ll long long\n#define maxn 1000005\n#define rep(i,x,y) for(int i&#x3D;x;i&lt;y;i++)\nll nxt[maxn], extend[maxn];\nvoid ekmp_pre(string x, ll next[])\n&#123;\n    int m &#x3D; x.length();\n    next[0] &#x3D; m;\n    int j &#x3D; 0;\n    while (j + 1 &lt; m &amp;&amp; x[j] &#x3D;&#x3D; x[j + 1])\n        j++;\n    next[1] &#x3D; j;\n    int k &#x3D; 1;\n    for (int i &#x3D; 2; i &lt; m; i++)\n    &#123;\n        int p &#x3D; next[k] + k - 1;\n        int L &#x3D; next[i - k];\n        if (i + L &lt; p + 1)\n            next[i] &#x3D; L;\n        else\n        &#123;\n            j &#x3D; max(0, p - i + 1);\n            while (i + j &lt; m &amp;&amp; x[i + j] &#x3D;&#x3D; x[j])\n                j++;\n            next[i] &#x3D; j;\n            k &#x3D; i;\n        &#125;\n    &#125;\n&#125;\nll ekmp(string x, string y, ll next[], ll extend[])\n&#123;\n    ekmp_pre(x, next);\n    int j &#x3D; 0;\n    ll ret &#x3D; 0;\n    int m &#x3D; x.length(), n &#x3D; y.length();\n    while (j &lt; n &amp;&amp; j &lt; m &amp;&amp; x[j] &#x3D;&#x3D; y[j])\n        j++;\n    extend[0] &#x3D; j;\n    int k &#x3D; 0;\n    for (int i &#x3D; 1; i &lt; n; i++)\n    &#123;\n        int p &#x3D; extend[k] + k - 1;\n        int L &#x3D; next[i - k];\n        if (i + L &lt; p + 1)\n            extend[i] &#x3D; L;\n        else\n        &#123;\n            j &#x3D; max(0, p - i + 1);\n            while (i + j &lt; n &amp;&amp; j &lt; m &amp;&amp; y[i + j] &#x3D;&#x3D; x[j])\n                j++;\n            extend[i] &#x3D; j;\n            k &#x3D; i;\n        &#125;\n    &#125;\n    rep(i, 0, n)\n    &#123;\n        ret &#x3D; (ret % mod + (((1 + extend[i])* extend[i])&gt;&gt;1) % mod) % mod;\n    &#125;\n    return ret;\n&#125;\nint main()\n&#123;\n    int t;\n    ios::sync_with_stdio(false);\n    cin &gt;&gt; t;\n    while (t--)\n    &#123;\n        string s, p;\n        cin &gt;&gt; s &gt;&gt; p;\n        reverse(s.begin(), s.end());\n        reverse(p.begin(), p.end());\n        memset(nxt, 0, p.length() + 1);\n        memset(extend, 0, s.length() + 1);\n        ll ans;\n        ans&#x3D;ekmp(p, s, nxt, extend);\n        cout&lt;&lt;ans&lt;&lt;endl;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>è§£æ³•äºŒï¼škmp</p>\n<pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">&#x2F;&#x2F; å¯„<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h2 id=\"0x03-Cow-Patterns-POJ-3167\"><a href=\"#0x03-Cow-Patterns-POJ-3167\" class=\"headerlink\" title=\"0x03 Cow Patterns POJ-3167\"></a>0x03 Cow Patterns POJ-3167</h2><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><a href=\"https://vjudge.net/problem/POJ-3167\">link</a> ç‰›é¢˜</p>\n<p>é¢˜æ„ï¼š</p>\n<p><strong>æ¨¡å¼ä¸²å¯ä»¥æµ®åŠ¨çš„æ¨¡å¼åŒ¹é…é—®é¢˜</strong></p>\n<p>ç»™å‡ºæ¨¡å¼ä¸²çš„ç›¸å¯¹å¤§å°é¡ºåºï¼Œéœ€è¦æ‰¾å‡ºåœ¨ä¸»ä¸²ä¸­æ¨¡å¼ä¸²çš„åŒ¹é…æ¬¡æ•°å’Œèµ·å§‹ä½ç½®</p>\n<p>æ ·ä¾‹ï¼š</p>\n<p>S: 5 6 2 10 10 7 3 2 9  </p>\n<p>P: 1 4 4 3 2 1</p>\n<p>æ•… 2 10 10 7 3 2 ç¬¦åˆè¦æ±‚ï¼Œè¾“å‡ºä¸º 1 3</p>\n<p>è§£æ³•ï¼š KMP+å‰ç¼€å’Œ</p>\n<p>ç»Ÿè®¡æ¯”å½“å‰æ•°å°ï¼Œå’Œäºå½“å‰æ•°ç›¸ç­‰çš„ï¼Œç„¶åè¿›è¡Œkmp</p></blockquote>\n<pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">&#x2F;&#x2F;POJ 3167\n#include &lt;cstdio&gt;\n#include &lt;cstring&gt;\n#include &lt;vector&gt;\nusing namespace std;\nconst int MAXN &#x3D; 100005;\nconst int MAXM &#x3D; 25005;\n\nint a[MAXN];       &#x2F;&#x2F; å­˜æ”¾ä¸»ä¸²\nint b[MAXM];       &#x2F;&#x2F; å­˜æ”¾æ¨¡å¼ä¸²\nint as[MAXN][30];  &#x2F;&#x2F; as[i][j] &#x3D; kè¡¨ç¤º0 - iä½ä¸­æœ‰kä¸ªæ•°å­—j\nint bs[MAXM][30];  &#x2F;&#x2F; bs[i][j] &#x3D; kè¡¨ç¤º0 - iä½ä¸­æœ‰kä¸ªæ•°å­—j\nint next[MAXM];    &#x2F;&#x2F; å­˜æ”¾æ¨¡å¼ä¸²å¤±é…æ—¶çš„ç§»åŠ¨ä½æ•°\nvector&lt;int&gt; ans;   &#x2F;&#x2F; å­˜æ”¾ç»“æœ\nint n, m, s;\n\nvoid Init() &#123;\n    ans.clear();\n    memset(as, 0, sizeof(as));\n    memset(bs, 0, sizeof(bs));\n    as[1][a[1]] &#x3D; 1;\n    bs[1][b[1]] &#x3D; 1;\n    for (int i &#x3D; 2; i &lt;&#x3D; n; ++i) &#123;\n        memcpy(as[i], as[i - 1], sizeof(as[0]));\n        ++as[i][a[i]];\n    &#125;\n    for (int i &#x3D; 2; i &lt;&#x3D; m; ++i) &#123;\n        memcpy(bs[i], bs[i - 1], sizeof(bs[0]));\n        ++bs[i][b[i]];\n    &#125;\n&#125;\n\nvoid GetNext() &#123;\n    memset(next, 0, sizeof(next));\n    int i &#x3D; 1, j &#x3D; 0, k &#x3D; 0;\n    next[1] &#x3D; 0;\n    while (i &lt;&#x3D; m) &#123;\n        int si &#x3D; 0, sj &#x3D; 0, ei &#x3D; 0, ej &#x3D; 0;\n        for (k &#x3D; 1; k &lt; b[i]; ++k)\n            si +&#x3D; bs[i][k] - bs[i - j][k];\n        ei &#x3D; bs[i][k] - bs[i - j][k];\n        for (k &#x3D; 1; k &lt; b[j]; ++k)\n            sj +&#x3D; bs[j][k];\n        ej &#x3D; bs[j][k];\n        if (0 &#x3D;&#x3D; j || (si &#x3D;&#x3D; sj &amp;&amp; ei &#x3D;&#x3D; ej))\n            next[++i] &#x3D; ++j;\n        else\n            j &#x3D; next[j];\n    &#125;\n&#125;\n\nvoid Kmp() &#123;\n    int i &#x3D; 1, j &#x3D; 1, k &#x3D; 1;\n    while (i &lt;&#x3D; n) &#123;\n        int si &#x3D; 0, sj &#x3D; 0, ei &#x3D; 0, ej &#x3D; 0;\n        for (k &#x3D; 1; k &lt; a[i]; ++k)\n            si +&#x3D; as[i][k] - as[i - j][k];\n        ei &#x3D; as[i][k] - as[i - j][k];\n        for (k &#x3D; 1; k &lt; b[j]; ++k)\n            sj +&#x3D; bs[j][k];\n        ej &#x3D; bs[j][k];\n        if (0 &#x3D;&#x3D; j || (si &#x3D;&#x3D; sj &amp;&amp; ei &#x3D;&#x3D; ej))\n            ++i, ++j;\n        else\n            j &#x3D; next[j];\n        if (j &#x3D;&#x3D; m + 1) &#123;\n            ans.push_back(i - m);\n            j &#x3D; next[j];\n        &#125;\n    &#125;\n&#125;\n\nint main() &#123;\n    while (scanf(&quot;%d %d %d&quot;, &amp;n, &amp;m, &amp;s) &#x3D;&#x3D; 3) &#123;\n        for (int i &#x3D; 1; i &lt;&#x3D; n; ++i)\n            scanf(&quot;%d&quot;, &amp;a[i]);\n        for (int i &#x3D; 1; i &lt;&#x3D; m; ++i)\n            scanf(&quot;%d&quot;, &amp;b[i]);\n        Init();\n        GetNext();\n        Kmp();\n        size_t len &#x3D; ans.size();\n        printf(&quot;%d\\n&quot;, len);\n        for (size_t i &#x3D; 0; i &lt; len; ++i)\n            printf(&quot;%d\\n&quot;, ans[i]);\n    &#125;\n    return 0;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n","text":"kmp/ekmp ä¸“é¢˜è®­ç»ƒ ğŸ´ç³™äººè ¢å‡‘åˆçœ‹ 0x01 å‰ªèŠ±å¸ƒæ¡ HDU-2087 link çº¯çº¯kmpè£¸é¢˜ï¼Œä¸å¯é‡å è®¡æ•° #include&lt;bits&#x2F;stdc++.h&gt; using namespace std; void kmp_pre(string p, ...","link":"","photos":[],"count_time":{"symbolsCount":"6.8k","symbolsTime":"6 mins."},"categories":[{"name":"ALGORITHM TRAINING","slug":"ALGORITHM-TRAINING","count":2,"path":"api/categories/ALGORITHM-TRAINING.json"}],"tags":[{"name":"ACM","slug":"ACM","count":20,"path":"api/tags/ACM.json"},{"name":"string","slug":"string","count":5,"path":"api/tags/string.json"},{"name":"algorithm","slug":"algorithm","count":8,"path":"api/tags/algorithm.json"},{"name":"dp","slug":"dp","count":3,"path":"api/tags/dp.json"},{"name":"kmp","slug":"kmp","count":1,"path":"api/tags/kmp.json"},{"name":"å‰ç¼€å’Œ","slug":"å‰ç¼€å’Œ","count":1,"path":"api/tags/å‰ç¼€å’Œ.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#kmp-ekmp-%E4%B8%93%E9%A2%98%E8%AE%AD%E7%BB%83\"><span class=\"toc-text\">kmp&#x2F;ekmp ä¸“é¢˜è®­ç»ƒ</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x01-%E5%89%AA%E8%8A%B1%E5%B8%83%E6%9D%A1-HDU-2087\"><span class=\"toc-text\">0x01 å‰ªèŠ±å¸ƒæ¡ HDU-2087</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x02-Secret-HDU-6153\"><span class=\"toc-text\">0x02 Secret HDU-6153</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x03-Cow-Patterns-POJ-3167\"><span class=\"toc-text\">0x03 Cow Patterns POJ-3167</span></a></li></ol></li></ol>","author":{"name":"Maskros","slug":"blog-author","avatar":"/img/logo_Maskros.jpg","link":"/","description":"Be Legendary within the hasty keys","socials":{"github":"https://github.com/Maskros-new","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"iconfont icon-bilibili-line","link":"https://space.bilibili.com/355516889"},"codeforces":{"icon":"iconfont icon-codeforces","link":"https://codeforces.com/profile/1ronMaker"},"mail":{"icon":"iconfont icon-mail","link":"mailto:1164528260@qq.com"}}}},"mapped":true,"prev_post":{"title":"Trie","uid":"f9c5a67ed89813cc4d2fda9f690375dd","slug":"algorithm/learn/trie","date":"2021-11-27T03:55:50.000Z","updated":"2022-01-22T09:37:06.172Z","comments":true,"path":"api/articles/algorithm/learn/trie.json","keywords":null,"cover":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimage.bubuko.com%2Finfo%2F202001%2F20200113201445546817.jpg&refer=http%3A%2F%2Fimage.bubuko.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1640577246&t=4f6b0ed3fef63f86e86da00e1973e1f0","text":"Trieå­—å…¸æ ‘/å‰ç¼€æ ‘ ä»€ä¹ˆæ˜¯Trie ä»æ ¹èŠ‚ç‚¹åˆ°æ¯ä¸ªå•è¯ç»“ç‚¹çš„è·¯å¾„ä¸Šæ‰€æœ‰å­—æ¯è¿æ¥æˆçš„å­—ç¬¦ä¸²å°±æ˜¯è¯¥ç»“ç‚¹å¯¹åº”çš„å­—ç¬¦ä¸² å¤šå‰æ ‘ï¼Œæœ€å¤§åˆ†æ”¯æ•°ç”±å­—å…¸çš„å­—ç¬¦é›†å«æœ‰çš„å­—ç¬¦æ•°å†³å®š æ“ä½œ æ’å…¥å­—ç¬¦ä¸² insert åˆå§‹åŒ– root = 0 , éå†å­—ç¬¦ä¸², å¯¹äºå…¶æ¯ä¸€ä¸ªå­—ç¬¦, è®¡ç®—å…¶æ˜ å°„å€¼ id...","link":"","photos":[],"count_time":{"symbolsCount":"4.8k","symbolsTime":"4 mins."},"categories":[{"name":"ALGORITHMS","slug":"ALGORITHMS","count":5,"path":"api/categories/ALGORITHMS.json"}],"tags":[{"name":"ACM","slug":"ACM","count":20,"path":"api/tags/ACM.json"},{"name":"string","slug":"string","count":5,"path":"api/tags/string.json"},{"name":"algorithm","slug":"algorithm","count":8,"path":"api/tags/algorithm.json"},{"name":"note","slug":"note","count":10,"path":"api/tags/note.json"},{"name":"Trie","slug":"Trie","count":2,"path":"api/tags/Trie.json"}],"author":{"name":"Maskros","slug":"blog-author","avatar":"/img/logo_Maskros.jpg","link":"/","description":"Be Legendary within the hasty keys","socials":{"github":"https://github.com/Maskros-new","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"iconfont icon-bilibili-line","link":"https://space.bilibili.com/355516889"},"codeforces":{"icon":"iconfont icon-codeforces","link":"https://codeforces.com/profile/1ronMaker"},"mail":{"icon":"iconfont icon-mail","link":"mailto:1164528260@qq.com"}}}}},"next_post":{"title":"2021CCPCå¹¿å·ç«™vp","uid":"38cc96ca6220c98ec8c78c52ef6fea74","slug":"xcpc/2021ccpc_guangzhou","date":"2021-11-24T16:42:00.000Z","updated":"2022-01-25T07:51:49.608Z","comments":true,"path":"api/articles/xcpc/2021ccpc_guangzhou.json","keywords":null,"cover":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_match%2F0%2F11826008261%2F0.jpg&refer=http%3A%2F%2Finews.gtimg.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1640364066&t=f43edaa90e76b5d34affabb3a3fd33d5","text":"2021CCPCå¹¿å·ç«™vp â€œå¦‚ä½•è§£æ–¹ç¨‹â€ C_Necklace äºŒåˆ†+è´ªå¿ƒ è¯»é¢˜æ¯”è¾ƒå…³é”® æ²¡æ”¹æ˜ç™½wa3 #include &lt;bits/stdc++.h> #define gcd(a, b) __gcd(a, b) #define INF 0x3f3f3f3f3f #de...","link":"","photos":[],"count_time":{"symbolsCount":"5.5k","symbolsTime":"5 mins."},"categories":[{"name":"SOLUTIONS","slug":"SOLUTIONS","count":11,"path":"api/categories/SOLUTIONS.json"}],"tags":[{"name":"solutions","slug":"solutions","count":11,"path":"api/tags/solutions.json"},{"name":"ACM","slug":"ACM","count":20,"path":"api/tags/ACM.json"},{"name":"äºŒåˆ†","slug":"äºŒåˆ†","count":5,"path":"api/tags/äºŒåˆ†.json"},{"name":"CCPC","slug":"CCPC","count":3,"path":"api/tags/CCPC.json"},{"name":"æ‰“è¡¨","slug":"æ‰“è¡¨","count":1,"path":"api/tags/æ‰“è¡¨.json"},{"name":"æ•°å­¦","slug":"æ•°å­¦","count":2,"path":"api/tags/æ•°å­¦.json"},{"name":"è´ªå¿ƒ","slug":"è´ªå¿ƒ","count":1,"path":"api/tags/è´ªå¿ƒ.json"}],"author":{"name":"Maskros","slug":"blog-author","avatar":"/img/logo_Maskros.jpg","link":"/","description":"Be Legendary within the hasty keys","socials":{"github":"https://github.com/Maskros-new","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"iconfont icon-bilibili-line","link":"https://space.bilibili.com/355516889"},"codeforces":{"icon":"iconfont icon-codeforces","link":"https://codeforces.com/profile/1ronMaker"},"mail":{"icon":"iconfont icon-mail","link":"mailto:1164528260@qq.com"}}}}}}